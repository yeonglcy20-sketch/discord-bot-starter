const { SlashCommandBuilder } = require('discord.js');

const menusByCat = {
  'í•œì‹': [
    'ðŸ¥˜ ê¹€ì¹˜ì°Œê°œ','ðŸ¥˜ ëœìž¥ì°Œê°œ','ðŸ² ë¶€ëŒ€ì°Œê°œ','ðŸ² ê°ìžíƒ•','ðŸ² ìˆœë‘ë¶€ì°Œê°œ','ðŸ² í•´ìž¥êµ­',
    'ðŸœ ëƒ‰ë©´','ðŸœ ì¹¼êµ­ìˆ˜','ðŸœ ìž”ì¹˜êµ­ìˆ˜','ðŸœ ì½©êµ­ìˆ˜','ðŸš ë¹„ë¹”ë°¥','ðŸš ëŒì†¥ë¹„ë¹”ë°¥',
    'ðŸ– ë¶ˆê³ ê¸°','ðŸ¥“ ì‚¼ê²¹ì‚´','ðŸ– ê°ˆë¹„íƒ•','ðŸ— ë‹­ê°ˆë¹„','ðŸ— ë‹­í•œë§ˆë¦¬','ðŸ— ì‚¼ê³„íƒ•',
    'ðŸ¥Ÿ ë§Œë‘ì „ê³¨','ðŸ¥© ìœ¡íšŒë¹„ë¹”ë°¥','ðŸ¥“ ì œìœ¡ë³¶ìŒ','ðŸ¥¢ ì˜¤ì§•ì–´ë³¶ìŒ','ðŸ¦‘ ë‚™ì§€ë³¶ìŒ',
    'ðŸ¥˜ ìˆœëŒ€êµ­','ðŸ¥˜ ê³±ì°½ì „ê³¨','ðŸ¥˜ ë¼ˆí•´ìž¥êµ­','ðŸ¥Ÿ ê¹€ì¹˜ì „','ðŸ¥ž í•´ë¬¼íŒŒì „','ðŸŒ¯ ê¹€ë°¥',
    'ðŸŒ¶ï¸ ë‹­ë°œ','ðŸ– ì¡±ë°œ','ðŸ¥© ë³´ìŒˆ','ðŸ”¥ ë§¤ìš´ë–¡ë³¶ì´','ðŸ¢ ì–´ë¬µíƒ•','ðŸœ ë¼ë³¶ì´'
  ],
  'ì¼ì‹': [
    'ðŸ£ ì´ˆë°¥','ðŸŸ ì‚¬ì‹œë¯¸','ðŸ› ì¼ë³¸ì‹ ì¹´ë ˆ','ðŸœ ë¼ë©˜','ðŸœ ìš°ë™','ðŸ¥¢ ì•¼í‚¤ì†Œë°”',
    'ðŸ¥© ëˆì¹´ì¸ ','ðŸš ê°€ì¸ ë™','ðŸ¤ í…ë™','ðŸ² ë‚˜ë² ','ðŸ™ ì˜¤ë‹ˆê¸°ë¦¬','ðŸ™ íƒ€ì½”ì•¼í‚¤',
    'ðŸ¥Ÿ êµìž','ðŸ¥¢ ì˜¤ì½”ë…¸ë¯¸ì•¼í‚¤'
  ],
  'ì¤‘ì‹': [
    'ðŸœ ì§œìž¥ë©´','ðŸ”¥ ì§¬ë½•','ðŸ– íƒ•ìˆ˜ìœ¡','ðŸ¥˜ ë§ˆíŒŒë‘ë¶€','ðŸ¥© ë¼ì¡°ê¸°','ðŸ¤ ê¹ì‡¼ìƒˆìš°',
    'ðŸ¥© ìœ ì‚°ìŠ¬','ðŸš ë³¶ìŒë°¥','ðŸœ ìš°ìœ¡ë©´','ðŸŒ¶ï¸ ë§ˆë¼íƒ•','ðŸŒ¶ï¸ ë§ˆë¼ìƒ¹ê¶ˆ','ðŸ² í› ê¶ˆ',
    'ðŸ¥Ÿ ë”¤ì„¬'
  ],
  'ì–‘ì‹': [
    'ðŸ• í”¼ìž','ðŸ í† ë§ˆí†  íŒŒìŠ¤íƒ€','ðŸ¥› í¬ë¦¼ íŒŒìŠ¤íƒ€','ðŸ§„ ì•Œë¦¬ì˜¤ì˜¬ë¦¬ì˜¤','ðŸ¥© ìŠ¤í…Œì´í¬',
    'ðŸ” ë ë“œë²„ê±°','ðŸŒ­ í•«ë„ê·¸','ðŸ¥— ì‹œì €ìƒëŸ¬ë“œ','ðŸš ë¦¬ì¡°ë˜','ðŸ¥˜ ë¹„í”„ìŠ¤íŠœ','ðŸ¥ª íŒŒë‹ˆë‹ˆ'
  ],
  'ë™ë‚¨ì•„': [
    'ðŸœ ë² íŠ¸ë‚¨ ìŒ€êµ­ìˆ˜(í¼)','ðŸ¥— ë¶„ì§œ','ðŸ¥– ë°˜ë¯¸','ðŸœ ì¹´ì˜¤ì˜ì´','ðŸ íŒŸíƒ€ì´',
    'ðŸš ì¹´ì˜¤íŒŸ(ë³¶ìŒë°¥)','ðŸ¦ ë˜ ì–Œê¿','ðŸ› ë½ì‚¬'
  ],
  'ì¸ë„/ì¤‘ë™': [
    'ðŸ› ë²„í„°ì¹˜í‚¨ ì»¤ë¦¬','ðŸ¥˜ íŒ”ë½ íŒŒë‹ˆë¥´','ðŸ¥˜ ë‹¬(ë Œí‹¸) ì»¤ë¦¬','ðŸ«“ ë‚œ','ðŸ¥Ÿ ì‚¬ëª¨ì‚¬',
    'ðŸ¥™ ì¼€ë°¥','ðŸŒ¯ ìƒ¤ì™€ë¥´ë§ˆ','ðŸ¥— íŒ”ë¼íŽ ','ðŸ¥£ í›„ë¬´ìŠ¤'
  ],
  'ë¶„ì‹/ì•¼ì‹': [
    'ðŸ— ì¹˜í‚¨','ðŸŸ ê°ìžíŠ€ê¹€','ðŸŒ® íƒ€ì½”','ðŸŒ¯ ë¶€ë¦¬ë˜','ðŸœ ì»µë¼ë©´',
    'ðŸ¢ ì˜¤ëŽ…ë°”','ðŸ• ì•¼ì‹ í”¼ìž','ðŸ¥ª íŽ¸ì˜ì  ìƒŒë“œìœ„ì¹˜'
  ],
  'ê°„ë‹¨ì‹': [
    'ðŸ¥ª ìƒŒë“œìœ„ì¹˜','ðŸ¥¯ ë² ì´ê¸€','ðŸž í† ìŠ¤íŠ¸','ðŸ™ ì£¼ë¨¹ë°¥','ðŸ¥— ìƒëŸ¬ë“œë³¼','ðŸ± ë„ì‹œë½'
  ],
  'ë””ì €íŠ¸': [
    'ðŸ§ ë¹™ìˆ˜','ðŸ¦ ì•„ì´ìŠ¤í¬ë¦¼','ðŸ§‡ ì™€í”Œ','ðŸ¥ž í¬ë ˆì´í”„','ðŸ© ë„ë„›',
    'ðŸ° ì¹˜ì¦ˆì¼€ì´í¬','ðŸ° í‹°ë¼ë¯¸ìˆ˜','ðŸ® í‘¸ë”©','ðŸ« ì´ˆì½œë¦¿ ì¼€ì´í¬','ðŸª ì¿ í‚¤','ðŸ§ ì»µì¼€ì´í¬'
  ],
  'ì±„ì‹': [
    'ðŸ¥— ë‘ë¶€ìƒëŸ¬ë“œ','ðŸ¥™ ë¹„ê±´ ëž©','ðŸ” ë¹„ê±´ ë²„ê±°','ðŸ í† ë§ˆí†  ì±„ì‹ íŒŒìŠ¤íƒ€','ðŸ² ì•¼ì±„ ìŠ¤íŠœ'
  ]
};

const ALL = Object.values(menusByCat).flat();

// ì¤‘ë³µ ì—†ì´ kê°œ ìƒ˜í”Œë§ (këŠ” 1~5ë¡œ ì œí•œ)
function sampleWithoutReplace(arr, k = 1) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  const n = Math.max(1, Math.min(k, 5, a.length));
  return a.slice(0, n);
}

module.exports = {
  // âš ï¸ ìŠ¬ëž˜ì‹œ ì´ë¦„ì€ ì˜ë¬¸ë§Œ ê°€ëŠ¥ â†’ 'ë©”ì¶”'
  data: new SlashCommandBuilder()
    .setName('ë©”ì¶”')
    .setDescription('ë©”ë‰´ë¥¼ ëžœë¤ìœ¼ë¡œ ì¶”ì²œí•´ì¤˜ìš”')
    .addStringOption(o =>
      o.setName('type')
       .setDescription('ì¹´í…Œê³ ë¦¬ ì„ íƒ (ë¯¸ì„ íƒ ì‹œ ì „ì²´ ëžœë¤)')
       .addChoices(
         { name: 'ì „ì²´', value: 'all' },
         { name: 'í•œì‹', value: 'í•œì‹' },
         { name: 'ì¼ì‹', value: 'ì¼ì‹' },
         { name: 'ì¤‘ì‹', value: 'ì¤‘ì‹' },
         { name: 'ì–‘ì‹', value: 'ì–‘ì‹' },
         { name: 'ë¶„ì‹/ì•¼ì‹', value: 'ë¶„ì‹/ì•¼ì‹' },
         { name: 'ë™ë‚¨ì•„', value: 'ë™ë‚¨ì•„' },
         { name: 'ì¸ë„/ì¤‘ë™', value: 'ì¸ë„/ì¤‘ë™' },
         { name: 'ê°„ë‹¨ì‹', value: 'ê°„ë‹¨ì‹' },
         { name: 'ë””ì €íŠ¸', value: 'ë””ì €íŠ¸' },
         { name: 'ì±„ì‹', value: 'ì±„ì‹' }
       )
    )
    .addIntegerOption(o =>
      o.setName('count')
       .setDescription('ì¶”ì²œ ê°œìˆ˜ (1~5, ê¸°ë³¸ 1)')
       .setMinValue(1)
       .setMaxValue(5)
    ),

  async execute(interaction) {
    const type = interaction.options.getString('type') || 'all';
    const count = interaction.options.getInteger('count') ?? 1;

    const pool = (type === 'all') ? ALL : (menusByCat[type] || ALL);
    const picks = sampleWithoutReplace(pool, count);

    await interaction.reply(
      `ì˜¤ëŠ˜ ë©”ë‰´ ì¶”ì²œ${picks.length > 1 ? ` (${type === 'all' ? 'ì „ì²´' : type}, ${picks.length}ê°œ)` : ` (${type === 'all' ? 'ì „ì²´' : type})`}: ` +
      picks.map(p => `**${p}**`).join(', ')
    );
  },
};
